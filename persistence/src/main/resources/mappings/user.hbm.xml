<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">

<hibernate-mapping>
    <class name="com.parkhomenko.common.domain.User" table="USERS" discriminator-value="USE">
        <meta attribute="class-description">
            This class contains the user detail.
        </meta>
        <id name="id" column="USER_ID" type="long">
            <generator class="org.hibernate.id.enhanced.SequenceStyleGenerator">
                <param name="sequence_name">user_id_seq</param>
            </generator>
        </id>

        <discriminator column="USER_DETAILS_TYPE" type="string"/>

        <property name="name" column="NAME" type="string"/>
        <property name="email" column="EMAIL" type="string"/>
        <property name="phone" column="PHONE" type="string"/>
        <property name="login" column="LOGIN" type="string"/>
        <property name="password" column="PASSWORD" type="string"/>
        <property name="blocked" column="BLOCKED" type="boolean"/>

        <subclass name="com.parkhomenko.common.domain.Admin" discriminator-value="ADM"/>

        <subclass name="com.parkhomenko.common.domain.Driver" discriminator-value="DRI">
            <join table="DRIVERS">
                <key column="DRIVER_ID"/>

                <component name="car" class="com.parkhomenko.common.domain.Car">
                    <property name="number" column="NUMBER" type="string"/>
                    <property name="brand" column="BRAND" type="string"/>
                </component>

                <property name="license" column="LICENSE" type="string"/>

                <many-to-one name="city" column="CITY_ID" class="com.parkhomenko.common.domain.City" not-null="true"/>
            </join>
        </subclass>

        <subclass name="com.parkhomenko.common.domain.Client" discriminator-value="CLI"/>
    </class>
</hibernate-mapping>